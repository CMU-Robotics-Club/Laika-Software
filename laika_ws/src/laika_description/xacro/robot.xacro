<?xml version="1.0"?>
<robot name="laika" xmlns:xacro="http://www.ros.org/wiki/xacro">
    <xacro:arg name="fly" default="false"/>
    <xacro:arg name="slide" default="false"/>
    <xacro:arg name="leg_only" default="false"/>
    <xacro:arg name="simulation" default="false"/>

    <xacro:include filename="$(find laika_description)/xacro/const.xacro"/>
    <xacro:include filename="$(find laika_description)/xacro/materials.xacro"/>
    <xacro:include filename="$(find laika_description)/xacro/leg_current.xacro"/>

    <!-- fly -->
    <xacro:if value="$(arg fly)">
      <link name="world"/>
      <joint name="fly_joint" type="fixed">
        <origin rpy="0 0 0" xyz="0 0 1"/>
        <parent link="world"/>
        <child link="base"/>
      </joint>
    </xacro:if>

    <!-- slide -->
    <xacro:if value="$(arg slide)">
      <link name="world"/>
      <link name="slider">
        <visual>
          <geometry>
            <box size="0.01 0.01 2.0"/>
          </geometry>
          <origin xyz="0 0 0"/>
        </visual>
        <inertial>
          <mass value="100"/>
          <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0"/>
        </inertial>
      </link>
      <joint name="world_to_slider" type="fixed">
        <origin rpy="0 0 0" xyz="0 0 1"/>
        <parent link="world"/>
        <child link="slider"/>
      </joint>
      <joint name="slider_to_base" type="prismatic">
        <axis xyz="0 0 1"/>
        <origin xyz="0.0 0.0 0.0"/>
        <parent link="slider"/>
        <child link="base"/>
        <limit effort="1000.0" lower="-1.0" upper="1.0" velocity="30"/>
        <dynamics damping="0.0" friction="0.0"/>
      </joint>
    </xacro:if>

    <link name="base"/>
    <!-- legs -->
    <xacro:if value="$(arg leg_only)">
      <xacro:leg>
        <!-- <origin xyz="0 0 0" rpy="0 0 ${-pi/2}"/> -->
        <origin xyz="0 0 0" rpy="${pi/2} 0 ${-pi/2}"/>
      </xacro:leg>
    </xacro:if>

    <!-- leg only -->
    <xacro:if value="$(arg leg_only)">
      <!-- simulation -->
      <xacro:if value="$(arg simulation)">
        <xacro:include filename="$(find laika_description)/xacro/leg_gazebo.xacro"/>
      </xacro:if>
      <!-- real -->
      <xacro:unless value="$(arg simulation)">
        <xacro:include filename="$(find laika_description)/xacro/leg_ros2_control.xacro"/>
      </xacro:unless>
    </xacro:if>
</robot>
